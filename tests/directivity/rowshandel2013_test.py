import time as time

import numpy as np

import openquake.hazardlib.geo as geo

from shakemap.grind.source import Source
import shakemap.grind.fault as fault
from shakemap.directivity.rowshandel2013 import Rowshandel2013
from shakemap.utils.timeutils import ShakeDateTime


def test_ss3():
    magnitude = 7.2
    dip = np.array([90])
    rake = 180.0
    width = np.array([15])
    fltx = np.array([0, 0])
    flty = np.array([0, 80])
    zp = np.array([0])
    epix = np.array([0])
    epiy = np.array([0.2 * flty[1]])
    
    # Convert to lat/lon
    proj = geo.utils.get_orthographic_projection(-122, -120, 39, 37)
    tlon,tlat = proj(fltx, flty, reverse = True)
    epilon,epilat = proj(epix, epiy, reverse = True)
    
    flt = fault.Fault.fromTrace(np.array([tlon[0]]), np.array([tlat[0]]), 
                                np.array([tlon[1]]), np.array([tlat[1]]),
                                zp, width, dip, reference = 'ss3')

    event = {'lat': epilat[0], 
             'lon': epilon[0], 
             'depth':10, 
             'mag': magnitude, 
             'id':'ss3',
             'locstring':'test',
             'type':'SS',
             'timezone':'UTC'}
    event['time'] = ShakeDateTime.utcfromtimestamp(int(time.time()))
    event['created'] = ShakeDateTime.utcfromtimestamp(int(time.time()))

    x = np.linspace(-60, 60, 21)
    y = np.linspace(-60, 138, 34)
    site_x, site_y = np.meshgrid(x, y)
    slon,slat = proj(site_x, site_y, reverse = True)
    deps = np.zeros_like(slon)
    source = Source(event, flt)
    source.setEventParam('rake', rake)

    test1 = Rowshandel2013(source, slat, slon, deps, dx = 1, T = [1.0, 3.0],
                           a_weight = 0.5, mtype = 1)
    # Test xiprime
    xip = test1.getXiPrime()

    xip_test = np.array(
      [[ 0.66384953,  0.69351618,  0.72374447,  0.75399824,  0.78355689,
         0.81150822,  0.8367708 ,  0.8581587 ,  0.8744947 ,  0.88476242,
         0.88826743,  0.88476242,  0.8744947 ,  0.8581587 ,  0.8367708 ,
         0.81150822,  0.78355689,  0.75399824,  0.72374447,  0.69351618,
         0.66384953],
       [ 0.6351166 ,  0.66663352,  0.69922428,  0.73236078,  0.76527433,
         0.79692394,  0.8259999 ,  0.85098841,  0.87031709,  0.88257791,
         0.88678363,  0.88257791,  0.87031709,  0.85098841,  0.8259999 ,
         0.79692394,  0.76527433,  0.73236078,  0.69922428,  0.66663352,
         0.6351166 ],
       [ 0.60181716,  0.63500161,  0.6698899 ,  0.7060103 ,  0.7425903 ,
         0.77848345,  0.81213093,  0.8431688 ,  0.86638766,  0.88129615,
         0.88644338,  0.88129615,  0.86638766,  0.8431688 ,  0.81213093,
         0.77848345,  0.7425903 ,  0.7060103 ,  0.6698899 ,  0.63500161,
         0.60181716],
       [ 0.56432635,  0.59888885,  0.63590108,  0.67501879,  0.71554433,
         0.75629034,  0.79546053,  0.83062171,  0.85887567,  0.87731881,
         0.88374369,  0.87731881,  0.85887567,  0.83062171,  0.79546053,
         0.75629034,  0.71554433,  0.67501879,  0.63590108,  0.59888885,
         0.56432635],
       [ 0.51976366,  0.55504948,  0.59360483,  0.63530904,  0.67966761,
         0.72559345,  0.77115304,  0.81337313,  0.84831146,  0.87165091,
         0.87988661,  0.87165091,  0.84831146,  0.81337313,  0.77115304,
         0.72559345,  0.67966761,  0.63530904,  0.59360483,  0.55504948,
         0.51976366],
       [ 0.46858648,  0.50371033,  0.54292327,  0.5853566 ,  0.6318032 ,
         0.68274   ,  0.73528595,  0.78605569,  0.82981198,  0.86003898,
         0.87091312,  0.86003898,  0.82981198,  0.78605569,  0.73528595,
         0.68274   ,  0.6318032 ,  0.5853566 ,  0.54292327,  0.50371033,
         0.46858648],
       [ 0.40814774,  0.44171922,  0.48004008,  0.52373261,  0.57324011,
         0.62849359,  0.68829116,  0.74931141,  0.80500029,  0.84547346,
         0.86049054,  0.84547346,  0.80500029,  0.74931141,  0.68829116,
         0.62849359,  0.57324011,  0.52373261,  0.48004008,  0.44171922,
         0.40814774],
       [ 0.34305909,  0.37374239,  0.40954118,  0.45069385,  0.49984949,
         0.55722102,  0.62293171,  0.69484935,  0.76602313,  0.8220696 ,
         0.84400968,  0.8220696 ,  0.76602313,  0.69484935,  0.62293171,
         0.55722102,  0.49984949,  0.45069385,  0.40954118,  0.37374239,
         0.34305909],
       [ 0.27154675,  0.29764445,  0.3287117 ,  0.36609105,  0.41150036,
         0.46700776,  0.53468672,  0.61529977,  0.70447538,  0.78450174,
         0.8192539 ,  0.78450174,  0.70447538,  0.61529977,  0.53468672,
         0.46700776,  0.41150036,  0.36609105,  0.3287117 ,  0.29764445,
         0.27154675],
       [ 0.19358669,  0.21329457,  0.23672894,  0.26602627,  0.30271598,
         0.34951213,  0.41015711,  0.48918433,  0.58932703,  0.6995601 ,
         0.75986516,  0.6995601 ,  0.58932703,  0.48918433,  0.41015711,
         0.34951213,  0.30271598,  0.26602627,  0.23672894,  0.21329457,
         0.19358669],
       [ 0.11570032,  0.12802571,  0.14311617,  0.1619774 ,  0.18613181,
         0.21795663,  0.26125803,  0.32212737,  0.40941224,  0.52939732,
         0.63628004,  0.52939732,  0.40941224,  0.32212737,  0.26125803,
         0.21795663,  0.18613181,  0.1619774 ,  0.14311617,  0.12802571,
         0.11570032],
       [ 0.07578258,  0.08365947,  0.09396562,  0.10696246,  0.12383431,
         0.14653577,  0.17847427,  0.22592568,  0.2997449 ,  0.42030881,
         0.5553117 ,  0.42030881,  0.2997449 ,  0.22592568,  0.17847427,
         0.14653577,  0.12383431,  0.10696246,  0.09396562,  0.08365947,
         0.07578258],
       [ 0.04098021,  0.04583798,  0.05182179,  0.05938729,  0.06926806,
         0.08271818,  0.10204853,  0.13193832,  0.18300037,  0.28160349,
         0.44384213,  0.28160349,  0.18300037,  0.13193832,  0.10204853,
         0.08271818,  0.06926806,  0.05938729,  0.05182179,  0.04583798,
         0.04098021],
       [ 0.03116619,  0.03432616,  0.0389328 ,  0.04475278,  0.05235538,
         0.06272115,  0.07767766,  0.10005173,  0.13887265,  0.21635784,
         0.36599053,  0.21635784,  0.13887265,  0.10005173,  0.07767766,
         0.06272115,  0.05235538,  0.04475278,  0.0389328 ,  0.03432616,
         0.03116619],
       [ 0.06429115,  0.07154829,  0.08049532,  0.09140175,  0.10560739,
         0.12535781,  0.15339968,  0.19574779,  0.26464291,  0.38334091,
         0.53114332,  0.38334091,  0.26464291,  0.19574779,  0.15339968,
         0.12535781,  0.10560739,  0.09140175,  0.08049532,  0.07154829,
         0.06429115],
       [ 0.1001735 ,  0.1109728 ,  0.12422798,  0.14085473,  0.16299592,
         0.19155105,  0.23087068,  0.28720289,  0.37050601,  0.49068746,
         0.60410377,  0.49068746,  0.37050601,  0.28720289,  0.23087068,
         0.19155105,  0.16299592,  0.14085473,  0.12422798,  0.1109728 ,
         0.1001735 ],
       [ 0.13972919,  0.1542221 ,  0.17186091,  0.19372462,  0.22139555,
         0.25723536,  0.30477949,  0.36910799,  0.45620597,  0.56652372,
         0.6552248 ,  0.56652372,  0.45620597,  0.36910799,  0.30477949,
         0.25723536,  0.22139555,  0.19372462,  0.17186091,  0.1542221 ,
         0.13972919],
       [ 0.18218402,  0.20034623,  0.22221712,  0.24894532,  0.28213054,
         0.32399586,  0.37710967,  0.44590304,  0.53289455,  0.63396101,
         0.70793226,  0.63396101,  0.53289455,  0.44590304,  0.37710967,
         0.32399586,  0.28213054,  0.24894532,  0.22221712,  0.20034623,
         0.18218402],
       [ 0.22338217,  0.24470009,  0.27007291,  0.30061871,  0.3378131 ,
         0.38356301,  0.44018679,  0.51003659,  0.59395956,  0.685934  ,
         0.74941958,  0.685934  ,  0.59395956,  0.51003659,  0.44018679,
         0.38356301,  0.3378131 ,  0.30061871,  0.27007291,  0.24470009,
         0.22338217],
       [ 0.26306145,  0.28699779,  0.31514804,  0.34853641,  0.38844415,
         0.43641297,  0.49373052,  0.56251263,  0.64204221,  0.72571001,
         0.78125677,  0.72571001,  0.64204221,  0.56251263,  0.49373052,
         0.43641297,  0.38844415,  0.34853641,  0.31514804,  0.28699779,
         0.26306145],
       [ 0.30111424,  0.32716638,  0.35719502,  0.39257834,  0.43415426,
         0.48312156,  0.54065445,  0.60744992,  0.68246624,  0.75908765,
         0.80861423,  0.75908765,  0.68246624,  0.60744992,  0.54065445,
         0.48312156,  0.43415426,  0.39257834,  0.35719502,  0.32716638,
         0.30111424],
       [ 0.33680012,  0.364456  ,  0.39624252,  0.43265328,  0.47477409,
         0.52383017,  0.58033323,  0.6445286 ,  0.71502077,  0.78545093,
         0.83012004,  0.78545093,  0.71502077,  0.6445286 ,  0.58033323,
         0.52383017,  0.47477409,  0.43265328,  0.39624252,  0.364456  ,
         0.33680012],
       [ 0.36945265,  0.39821926,  0.43093862,  0.46824917,  0.51083863,
         0.5593785 ,  0.61436745,  0.6757582 ,  0.74198983,  0.80705921,
         0.84777247,  0.80705921,  0.74198983,  0.6757582 ,  0.61436745,
         0.5593785 ,  0.51083863,  0.46824917,  0.43093862,  0.39821926,
         0.36945265],
       [ 0.39958251,  0.42907789,  0.46230535,  0.4997888 ,  0.5420668 ,
         0.58962725,  0.64276367,  0.7012434 ,  0.76345038,  0.82376943,
         0.86114536,  0.82376943,  0.76345038,  0.7012434 ,  0.64276367,
         0.58962725,  0.5420668 ,  0.4997888 ,  0.46230535,  0.42907789,
         0.39958251],
       [ 0.45175002,  0.48329114,  0.51848556,  0.55776359,  0.6015338 ,
         0.65010635,  0.70353054,  0.76122121,  0.82097897,  0.87594246,
         0.90389777,  0.87594246,  0.82097897,  0.76122121,  0.70353054,
         0.65010635,  0.6015338 ,  0.55776359,  0.51848556,  0.48329114,
         0.45175002],
       [ 0.51124221,  0.54468233,  0.58155745,  0.62214181,  0.66661427,
         0.71493972,  0.7666297 ,  0.82022832,  0.87214946,  0.91422302,
         0.93164373,  0.91422302,  0.87214946,  0.82022832,  0.7666297 ,
         0.71493972,  0.66661427,  0.62214181,  0.58155745,  0.54468233,
         0.51124221],
       [ 0.56437299,  0.59864394,  0.63592048,  0.67627584,  0.71960771,
         0.76548796,  0.81289211,  0.85971519,  0.90198598,  0.93308317,
         0.94484242,  0.93308317,  0.90198598,  0.85971519,  0.81289211,
         0.76548796,  0.71960771,  0.67627584,  0.63592048,  0.59864394,
         0.56437299],
       [ 0.61132071,  0.64552488,  0.68218033,  0.72116218,  0.76211598,
         0.80431065,  0.8464128 ,  0.88617298,  0.92011325,  0.94360486,
         0.95210218,  0.94360486,  0.92011325,  0.88617298,  0.8464128 ,
         0.80431065,  0.76211598,  0.72116218,  0.68218033,  0.64552488,
         0.61132071],
       [ 0.65213998,  0.68556613,  0.72120955,  0.75807965,  0.79598962,
         0.83404673,  0.87084974,  0.90434518,  0.93179572,  0.95008097,
         0.95653511,  0.95008097,  0.93179572,  0.90434518,  0.87084974,
         0.83404673,  0.79598962,  0.75807965,  0.72120955,  0.68556613,
         0.65213998],
       [ 0.68797917,  0.72015381,  0.75361177,  0.78795999,  0.822575  ,
         0.85652609,  0.88850076,  0.91677066,  0.9392717 ,  0.95388998,
         0.95897393,  0.95388998,  0.9392717 ,  0.91677066,  0.88850076,
         0.85652609,  0.822575  ,  0.78795999,  0.75361177,  0.72015381,
         0.68797917],
       [ 0.7190968 ,  0.74970664,  0.78109111,  0.81279939,  0.84418302,
         0.87435345,  0.90215669,  0.92619369,  0.94492497,  0.95688887,
         0.96100983,  0.95688887,  0.94492497,  0.92619369,  0.90215669,
         0.87435345,  0.84418302,  0.81279939,  0.78109111,  0.74970664,
         0.7190968 ],
       [ 0.74606909,  0.77494372,  0.80416493,  0.8332641 ,  0.86161339,
         0.88840784,  0.91266809,  0.93328086,  0.94909455,  0.95907401,
         0.96248878,  0.95907401,  0.94909455,  0.93328086,  0.91266809,
         0.88840784,  0.86161339,  0.8332641 ,  0.80416493,  0.77494372,
         0.74606909],
       [ 0.76944467,  0.79652012,  0.82359714,  0.85021696,  0.87579816,
         0.89963415,  0.92090907,  0.93874142,  0.95226144,  0.96071849,
         0.96359863,  0.96071849,  0.95226144,  0.93874142,  0.92090907,
         0.89963415,  0.87579816,  0.85021696,  0.82359714,  0.79652012,
         0.76944467],
       [ 0.78932768,  0.81460117,  0.84003067,  0.8643514 ,  0.88744975,
         0.90871685,  0.92747892,  0.94303676,  0.95472541,  0.96198839,
         0.96445316,  0.96198839,  0.95472541,  0.94303676,  0.92747892,
         0.90871685,  0.88744975,  0.8643514 ,  0.84003067,  0.81460117,
         0.78932768]])

    np.testing.assert_allclose(
        xip, xip_test, rtol = 1e-5)

    # Test fd
    fd = test1.getFd()
    fd1 = fd[0]
    fd3 = fd[1]
    fd1_test = np.array(
      [[  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   9.44633615e-03,
          1.67262299e-02,   1.93647287e-02,   1.67262299e-02,
          9.44633615e-03,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          5.54935489e-03,   1.98534029e-02,   3.34199045e-02,
          4.33980173e-02,   4.71017068e-02,   4.33980173e-02,
          3.34199045e-02,   1.98534029e-02,   5.54935489e-03,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   3.97068660e-03,
          1.86446809e-02,   3.62091446e-02,   5.41758081e-02,
          6.82609096e-02,   7.36917337e-02,   6.82609096e-02,
          5.41758081e-02,   3.62091446e-02,   1.86446809e-02,
          3.97068660e-03,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   9.60171635e-03,
          2.50208251e-02,   4.56420250e-02,   6.91801331e-02,
          8.51232686e-02,   8.89738461e-02,   8.51232686e-02,
          6.91801331e-02,   4.56420250e-02,   2.50208251e-02,
          9.60171635e-03,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   1.29231101e-03,   8.70206493e-03,
          2.27639665e-02,   4.47880963e-02,   6.44849904e-02,
          7.85299524e-02,   8.46291022e-02,   7.85299524e-02,
          6.44849904e-02,   4.47880963e-02,   2.27639665e-02,
          8.70206493e-03,   1.29231101e-03,   0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -1.03046689e-03,   1.02128844e-03,
          9.75683623e-03,   2.67005064e-02,   4.42759702e-02,
          6.36223381e-02,   7.42061288e-02,   6.36223381e-02,
          4.42759702e-02,   2.67005064e-02,   9.75683623e-03,
          1.02128844e-03,  -1.03046689e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -5.18320923e-03,  -1.03755228e-02,
         -1.06030172e-02,  -2.61869187e-03,   1.27001699e-02,
          3.37580557e-02,   5.25164218e-02,   3.37580557e-02,
          1.27001699e-02,  -2.61869187e-03,  -1.06030172e-02,
         -1.03755228e-02,  -5.18320923e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -7.32260200e-03,  -1.65977058e-02,
         -2.21843110e-02,  -1.95024929e-02,  -6.54690920e-03,
          1.46125634e-02,   3.83061370e-02,   1.46125634e-02,
         -6.54690920e-03,  -1.95024929e-02,  -2.21843110e-02,
         -1.65977058e-02,  -7.32260200e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -9.19636001e-03,  -2.21573724e-02,
         -3.28760082e-02,  -3.59976696e-02,  -2.70360654e-02,
         -9.73080299e-03,   1.87427603e-02,  -9.73080299e-03,
         -2.70360654e-02,  -3.59976696e-02,  -3.28760082e-02,
         -2.21573724e-02,  -9.19636001e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -9.77691417e-03,  -2.38992902e-02,
         -3.62852090e-02,  -4.15939000e-02,  -3.47806657e-02,
         -2.11816895e-02,   5.07947723e-03,  -2.11816895e-02,
         -3.47806657e-02,  -4.15939000e-02,  -3.62852090e-02,
         -2.38992902e-02,  -9.77691417e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -7.94791050e-03,  -1.84422063e-02,
         -2.56917361e-02,  -2.47988394e-02,  -1.27074567e-02,
          8.12454071e-03,   3.40644846e-02,   8.12454071e-03,
         -1.27074567e-02,  -2.47988394e-02,  -2.56917361e-02,
         -1.84422063e-02,  -7.94791050e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -5.97695745e-03,  -1.26753971e-02,
         -1.48537426e-02,  -8.74808504e-03,   5.87196238e-03,
          2.69643112e-02,   4.68693510e-02,   2.69643112e-02,
          5.87196238e-03,  -8.74808504e-03,  -1.48537426e-02,
         -1.26753971e-02,  -5.97695745e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -3.97139888e-03,  -6.95305458e-03,
         -4.51422892e-03,   5.62660345e-03,   2.09126661e-02,
          4.02738940e-02,   5.58413054e-02,   4.02738940e-02,
          2.09126661e-02,   5.62660345e-03,  -4.51422892e-03,
         -6.95305458e-03,  -3.97139888e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,  -1.88576749e-03,  -1.13707954e-03,
          5.60432832e-03,   1.91044577e-02,   3.43718343e-02,
          5.21094219e-02,   6.50916876e-02,   5.21094219e-02,
          3.43718343e-02,   1.91044577e-02,   5.60432832e-03,
         -1.13707954e-03,  -1.88576749e-03,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
         -0.00000000e+00,   2.62598361e-05,   4.05213951e-03,
          1.44283655e-02,   3.03601653e-02,   4.50889986e-02,
          6.12308991e-02,   7.23728852e-02,   6.12308991e-02,
          4.50889986e-02,   3.03601653e-02,   1.44283655e-02,
          4.05213951e-03,   2.62598361e-05,  -0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00,
          0.00000000e+00,   1.76473223e-03,   8.65611094e-03,
          2.19187061e-02,   3.95699301e-02,   5.35277065e-02,
          6.82117560e-02,   7.79604460e-02,   6.82117560e-02,
          5.35277065e-02,   3.95699301e-02,   2.19187061e-02,
          8.65611094e-03,   1.76473223e-03,   0.00000000e+00,
         -0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,  -0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   3.33414573e-03,   1.27250138e-02,
          2.84829602e-02,   4.74566139e-02,   6.06222932e-02,
          7.40696728e-02,   8.27617954e-02,   7.40696728e-02,
          6.06222932e-02,   4.74566139e-02,   2.84829602e-02,
          1.27250138e-02,   3.33414573e-03,   0.00000000e+00,
          0.00000000e+00,  -0.00000000e+00,  -0.00000000e+00],
       [ -0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   4.72869900e-03,   1.62711639e-02,
          3.40336371e-02,   5.39640777e-02,   6.63357496e-02,
          7.86965398e-02,   8.65361563e-02,   7.86965398e-02,
          6.63357496e-02,   5.39640777e-02,   3.40336371e-02,
          1.62711639e-02,   4.72869900e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,  -0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   5.96677549e-03,   1.93677118e-02,
          3.87946123e-02,   5.94450038e-02,   7.10689337e-02,
          8.24888825e-02,   8.96342308e-02,   8.24888825e-02,
          7.10689337e-02,   5.94450038e-02,   3.87946123e-02,
          1.93677118e-02,   5.96677549e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   7.03873767e-03,   2.20025473e-02,
          4.27668053e-02,   6.39177640e-02,   7.48353493e-02,
          8.54215972e-02,   9.19812288e-02,   8.54215972e-02,
          7.48353493e-02,   6.39177640e-02,   4.27668053e-02,
          2.20025473e-02,   7.03873767e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   8.56837743e-03,   2.65450098e-02,
          5.02081550e-02,   7.44441213e-02,   8.49318594e-02,
          9.45781826e-02,   9.94844576e-02,   9.45781826e-02,
          8.49318594e-02,   7.44441213e-02,   5.02081550e-02,
          2.65450098e-02,   8.56837743e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   7.39211230e-03,   2.75644673e-02,
          5.25931796e-02,   8.21617019e-02,   9.39124946e-02,
          1.01296581e-01,   1.04353989e-01,   1.01296581e-01,
          9.39124946e-02,   8.21617019e-02,   5.25931796e-02,
          2.75644673e-02,   7.39211230e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   1.79141089e-03,   2.23566766e-02,
          4.64336976e-02,   7.29262708e-02,   9.91489306e-02,
          1.04606618e-01,   1.06670415e-01,   1.04606618e-01,
          9.91489306e-02,   7.29262708e-02,   4.64336976e-02,
          2.23566766e-02,   1.79141089e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   1.13088919e-02,
          3.31724668e-02,   5.57652180e-02,   7.65208121e-02,
          9.16846628e-02,   9.73333940e-02,   9.16846628e-02,
          7.65208121e-02,   5.57652180e-02,   3.31724668e-02,
          1.13088919e-02,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          1.45939742e-02,   3.34793162e-02,   4.99179573e-02,
          6.13434340e-02,   6.54669059e-02,   6.13434340e-02,
          4.99179573e-02,   3.34793162e-02,   1.45939742e-02,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   7.90515187e-03,   2.10504075e-02,
          2.98956648e-02,   3.30277256e-02,   2.98956648e-02,
          2.10504075e-02,   7.90515187e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   3.31203639e-04,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00]])
    fd3_test = np.array(
      [[  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   5.13100766e-03,
          1.05086885e-02,   1.23647233e-02,   1.05086885e-02,
          5.13100766e-03,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   1.23998575e-03,
          1.55201691e-02,   2.84127934e-02,   3.87528393e-02,
          4.54700527e-02,   4.78016377e-02,   4.54700527e-02,
          3.87528393e-02,   2.84127934e-02,   1.55201691e-02,
          1.23998575e-03,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   8.69983569e-03,   2.57055567e-02,
          4.27875237e-02,   5.87553928e-02,   7.17036058e-02,
          8.02363090e-02,   8.32206200e-02,   8.02363090e-02,
          7.17036058e-02,   5.87553928e-02,   4.27875237e-02,
          2.57055567e-02,   8.69983569e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          9.31786240e-03,   2.71482779e-02,   4.68809526e-02,
          6.73501684e-02,   8.68429492e-02,   1.03205633e-01,
          1.14200407e-01,   1.18086380e-01,   1.14200407e-01,
          1.03205633e-01,   8.68429492e-02,   6.73501684e-02,
          4.68809526e-02,   2.71482779e-02,   9.31786240e-03,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   5.30826443e-03,
          2.12788945e-02,   4.07758085e-02,   6.32748135e-02,
          8.75921988e-02,   1.11680962e-01,   1.32627295e-01,
          1.47090342e-01,   1.52279399e-01,   1.47090342e-01,
          1.32627295e-01,   1.11680962e-01,   8.75921988e-02,
          6.32748135e-02,   4.07758085e-02,   2.12788945e-02,
          5.30826443e-03,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   2.02584718e-04,   1.17569412e-02,
          2.75782890e-02,   4.78882401e-02,   7.27524753e-02,
          1.01086613e-01,   1.30667128e-01,   1.57681842e-01,
          1.74595575e-01,   1.78225807e-01,   1.74595575e-01,
          1.57681842e-01,   1.30667128e-01,   1.01086613e-01,
          7.27524753e-02,   4.78882401e-02,   2.75782890e-02,
          1.17569412e-02,   2.02584718e-04,   0.00000000e+00],
       [  0.00000000e+00,   3.13438749e-03,   1.26696014e-02,
          2.72200961e-02,   4.74801012e-02,   7.38678219e-02,
          1.06039667e-01,   1.37630206e-01,   1.56221419e-01,
          1.69733012e-01,   1.74746326e-01,   1.69733012e-01,
          1.56221419e-01,   1.37630206e-01,   1.06039667e-01,
          7.38678219e-02,   4.74801012e-02,   2.72200961e-02,
          1.26696014e-02,   3.13438749e-03,   0.00000000e+00],
       [  0.00000000e+00,   1.95279078e-03,   8.28875653e-03,
          1.98334380e-02,   3.79930934e-02,   6.39093006e-02,
          9.54395137e-02,   1.19448550e-01,   1.43209256e-01,
          1.61919850e-01,   1.69244345e-01,   1.61919850e-01,
          1.43209256e-01,   1.19448550e-01,   9.54395137e-02,
          6.39093006e-02,   3.79930934e-02,   1.98334380e-02,
          8.28875653e-03,   1.95279078e-03,   0.00000000e+00],
       [ -4.57274123e-04,  -2.77388302e-03,  -1.11276914e-03,
          5.69520526e-03,   1.92114051e-02,   4.14488899e-02,
          6.59797421e-02,   9.28916616e-02,   1.22662113e-01,
          1.49378170e-01,   1.60979856e-01,   1.49378170e-01,
          1.22662113e-01,   9.28916616e-02,   6.59797421e-02,
          4.14488899e-02,   1.92114051e-02,   5.69520526e-03,
         -1.11276914e-03,  -2.77388302e-03,  -4.57274123e-04],
       [ -2.36709406e-03,  -1.00170537e-02,  -1.45763492e-02,
         -1.48813159e-02,  -9.39254106e-03,   4.16092128e-03,
          2.44066856e-02,   5.07891914e-02,   8.42209019e-02,
          1.21021192e-01,   1.41153476e-01,   1.21021192e-01,
          8.42209019e-02,   5.07891914e-02,   2.44066856e-02,
          4.16092128e-03,  -9.39254106e-03,  -1.48813159e-02,
         -1.45763492e-02,  -1.00170537e-02,  -2.36709406e-03],
       [ -4.36097090e-03,  -1.76623743e-02,  -2.89536398e-02,
         -3.74819379e-02,  -4.20896641e-02,  -3.97576618e-02,
         -2.53018917e-02,  -4.98122548e-03,   2.41580198e-02,
          6.42139265e-02,   9.98957309e-02,   6.42139265e-02,
          2.41580198e-02,  -4.98122548e-03,  -2.53018917e-02,
         -3.97576618e-02,  -4.20896641e-02,  -3.74819379e-02,
         -2.89536398e-02,  -1.76623743e-02,  -4.36097090e-03],
       [ -5.14690592e-03,  -2.14108599e-02,  -3.62913208e-02,
         -4.92600811e-02,  -5.94637883e-02,  -6.36008538e-02,
         -5.29384818e-02,  -3.70972682e-02,  -1.24534052e-02,
          2.77957379e-02,   7.28651996e-02,   2.77957379e-02,
         -1.24534052e-02,  -3.70972682e-02,  -5.29384818e-02,
         -6.36008538e-02,  -5.94637883e-02,  -4.92600811e-02,
         -3.62913208e-02,  -2.14108599e-02,  -5.14690592e-03],
       [ -5.83192015e-03,  -2.46061807e-02,  -4.25827791e-02,
         -5.94452691e-02,  -7.46815871e-02,  -8.49057645e-02,
         -7.84525068e-02,  -6.84740771e-02,  -5.14274854e-02,
         -1.85097469e-02,   3.56521193e-02,  -1.85097469e-02,
         -5.14274854e-02,  -6.84740771e-02,  -7.84525068e-02,
         -8.49057645e-02,  -7.46815871e-02,  -5.94452691e-02,
         -4.25827791e-02,  -2.46061807e-02,  -5.83192015e-03],
       [ -6.02462708e-03,  -2.55783440e-02,  -4.45065609e-02,
         -6.25780069e-02,  -7.93980456e-02,  -9.15815862e-02,
         -8.65884957e-02,  -7.91191193e-02,  -6.61591156e-02,
         -4.02914038e-02,   9.66208423e-03,  -4.02914038e-02,
         -6.61591156e-02,  -7.91191193e-02,  -8.65884957e-02,
         -9.15815862e-02,  -7.93980456e-02,  -6.25780069e-02,
         -4.45065609e-02,  -2.55783440e-02,  -6.02462708e-03],
       [ -5.37165805e-03,  -2.24328050e-02,  -3.83011598e-02,
         -5.25905140e-02,  -6.45463120e-02,  -7.06709194e-02,
         -6.13093998e-02,  -4.71718770e-02,  -2.41718806e-02,
          1.54543456e-02,   6.47968096e-02,   1.54543456e-02,
         -2.41718806e-02,  -4.71718770e-02,  -6.13093998e-02,
         -7.06709194e-02,  -6.45463120e-02,  -5.25905140e-02,
         -3.83011598e-02,  -2.24328050e-02,  -5.37165805e-03],
       [ -4.66452219e-03,  -1.91013185e-02,  -3.17719111e-02,
         -4.20028447e-02,  -4.85410736e-02,  -4.85729189e-02,
         -3.54464245e-02,  -1.66404397e-02,   1.11695343e-02,
          5.12909959e-02,   8.91539810e-02,   5.12909959e-02,
          1.11695343e-02,  -1.66404397e-02,  -3.54464245e-02,
         -4.85729189e-02,  -4.85410736e-02,  -4.20028447e-02,
         -3.17719111e-02,  -1.91013185e-02,  -4.66452219e-03],
       [ -3.88520135e-03,  -1.54468197e-02,  -2.46605365e-02,
         -3.06837959e-02,  -3.22539938e-02,  -2.66448200e-02,
         -1.07726536e-02,   1.07028172e-02,   3.97796726e-02,
          7.66082291e-02,   1.06220261e-01,   7.66082291e-02,
          3.97796726e-02,   1.07028172e-02,  -1.07726536e-02,
         -2.66448200e-02,  -3.22539938e-02,  -3.06837959e-02,
         -2.46605365e-02,  -1.54468197e-02,  -3.88520135e-03],
       [ -3.04895978e-03,  -1.15495892e-02,  -1.71427645e-02,
         -1.88616201e-02,  -1.53157633e-02,  -4.35744706e-03,
          1.33741068e-02,   3.63401333e-02,   6.53814444e-02,
          9.91215435e-02,   1.23816161e-01,   9.91215435e-02,
          6.53814444e-02,   3.63401333e-02,   1.33741068e-02,
         -4.35744706e-03,  -1.53157633e-02,  -1.88616201e-02,
         -1.71427645e-02,  -1.15495892e-02,  -3.04895978e-03],
       [ -2.23762628e-03,  -7.80208615e-03,  -9.99842872e-03,
         -7.79902037e-03,   2.13281271e-04,   1.55284946e-02,
          3.44318183e-02,   5.77505244e-02,   8.57674289e-02,
          1.16472243e-01,   1.37666315e-01,   1.16472243e-01,
          8.57674289e-02,   5.77505244e-02,   3.44318183e-02,
          1.55284946e-02,   2.13281271e-04,  -7.79902037e-03,
         -9.99842872e-03,  -7.80208615e-03,  -2.23762628e-03],
       [ -1.45635446e-03,  -4.22845472e-03,  -3.26935052e-03,
          2.45940430e-03,   1.43334136e-02,   3.31719622e-02,
          5.23068945e-02,   7.52691626e-02,   1.01819377e-01,
          1.29751095e-01,   1.48294866e-01,   1.29751095e-01,
          1.01819377e-01,   7.52691626e-02,   5.23068945e-02,
          3.31719622e-02,   1.43334136e-02,   2.45940430e-03,
         -3.26935052e-03,  -4.22845472e-03,  -1.45635446e-03],
       [ -7.07253358e-04,  -8.34845985e-04,   3.00753367e-03,
          1.18879627e-02,   2.70810677e-02,   4.87651916e-02,
          6.79720140e-02,   9.02710613e-02,   1.15314564e-01,
          1.40893912e-01,   1.57427901e-01,   1.40893912e-01,
          1.15314564e-01,   9.02710613e-02,   6.79720140e-02,
          4.87651916e-02,   2.70810677e-02,   1.18879627e-02,
          3.00753367e-03,  -8.34845985e-04,  -7.07253358e-04],
       [ -4.88480838e-06,   2.31540213e-03,   8.83652178e-03,
          2.04671430e-02,   3.84090311e-02,   6.23553840e-02,
          8.12184077e-02,   1.02649434e-01,   1.26182591e-01,
          1.49695049e-01,   1.64607418e-01,   1.49695049e-01,
          1.26182591e-01,   1.02649434e-01,   8.12184077e-02,
          6.23553840e-02,   3.84090311e-02,   2.04671430e-02,
          8.83652178e-03,   2.31540213e-03,  -4.88480838e-06],
       [  6.37651059e-04,   5.16761589e-03,   1.40158148e-02,
          2.80873423e-02,   4.84665226e-02,   7.42228635e-02,
          9.25804160e-02,   1.13075147e-01,   1.35185963e-01,
          1.56908771e-01,   1.70500516e-01,   1.56908771e-01,
          1.35185963e-01,   1.13075147e-01,   9.25804160e-02,
          7.42228635e-02,   4.84665226e-02,   2.80873423e-02,
          1.40158148e-02,   5.16761589e-03,   6.37651059e-04],
       [  1.23042041e-03,   7.77433516e-03,   1.86979964e-02,
          3.48390856e-02,   5.71751655e-02,   8.43211289e-02,
          1.02060230e-01,   1.21583145e-01,   1.42350367e-01,
          1.62487325e-01,   1.74964930e-01,   1.62487325e-01,
          1.42350367e-01,   1.21583145e-01,   1.02060230e-01,
          8.43211289e-02,   5.71751655e-02,   3.48390856e-02,
          1.86979964e-02,   7.77433516e-03,   1.23042041e-03],
       [  2.09259812e-03,   1.21215903e-02,   2.67602332e-02,
          4.67999756e-02,   7.31306054e-02,   1.04511516e-01,
          1.22346687e-01,   1.41606180e-01,   1.61555755e-01,
          1.79904806e-01,   1.89237428e-01,   1.79904806e-01,
          1.61555755e-01,   1.41606180e-01,   1.22346687e-01,
          1.04511516e-01,   7.31306054e-02,   4.67999756e-02,
          2.67602332e-02,   1.21215903e-02,   2.09259812e-03],
       [  1.88066315e-03,   1.54953885e-02,   3.37972061e-02,
          5.74431905e-02,   8.70926899e-02,   1.23299467e-01,
          1.43411754e-01,   1.61305156e-01,   1.78638547e-01,
          1.92684415e-01,   1.98500158e-01,   1.92684415e-01,
          1.78638547e-01,   1.61305156e-01,   1.43411754e-01,
          1.23299467e-01,   8.70926899e-02,   5.74431905e-02,
          3.37972061e-02,   1.54953885e-02,   1.88066315e-03],
       [  0.00000000e+00,   1.55893876e-02,   3.62944149e-02,
          6.19122973e-02,   9.27612976e-02,   1.28871633e-01,
          1.58856031e-01,   1.74487482e-01,   1.88599195e-01,
          1.98980703e-01,   2.02906418e-01,   1.98980703e-01,
          1.88599195e-01,   1.74487482e-01,   1.58856031e-01,
          1.28871633e-01,   9.27612976e-02,   6.19122973e-02,
          3.62944149e-02,   1.55893876e-02,   0.00000000e+00],
       [  0.00000000e+00,   1.18044746e-02,   3.37517423e-02,
          5.99358446e-02,   9.03280535e-02,   1.24497923e-01,
          1.61307898e-01,   1.83320169e-01,   1.94650816e-01,
          2.02493270e-01,   2.05330023e-01,   2.02493270e-01,
          1.94650816e-01,   1.83320169e-01,   1.61307898e-01,
          1.24497923e-01,   9.03280535e-02,   5.99358446e-02,
          3.37517423e-02,   1.18044746e-02,   0.00000000e+00],
       [  0.00000000e+00,   3.92485056e-03,   2.61622902e-02,
          5.18547954e-02,   8.07001434e-02,   1.11966986e-01,
          1.44282778e-01,   1.75398756e-01,   1.98550901e-01,
          2.04655262e-01,   2.06809916e-01,   2.04655262e-01,
          1.98550901e-01,   1.75398756e-01,   1.44282778e-01,
          1.11966986e-01,   8.07001434e-02,   5.18547954e-02,
          2.61622902e-02,   3.92485056e-03,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   1.38348484e-02,
          3.83121291e-02,   6.49939688e-02,   9.30093959e-02,
          1.20980244e-01,   1.46941180e-01,   1.68407027e-01,
          1.82727437e-01,   1.87776371e-01,   1.82727437e-01,
          1.68407027e-01,   1.46941180e-01,   1.20980244e-01,
          9.30093959e-02,   6.49939688e-02,   3.83121291e-02,
          1.38348484e-02,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          2.01833295e-02,   4.44879406e-02,   6.93243144e-02,
          9.34297087e-02,   1.15175986e-01,   1.32688521e-01,
          1.44128692e-01,   1.48114741e-01,   1.44128692e-01,
          1.32688521e-01,   1.15175986e-01,   9.34297087e-02,
          6.93243144e-02,   4.44879406e-02,   2.01833295e-02,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   2.01107289e-02,   4.20018327e-02,
          6.27670658e-02,   8.10911849e-02,   9.55617965e-02,
          1.04874679e-01,   1.08093170e-01,   1.04874679e-01,
          9.55617965e-02,   8.10911849e-02,   6.27670658e-02,
          4.20018327e-02,   2.01107289e-02,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   1.19293415e-02,
          2.98538285e-02,   4.53996524e-02,   5.74953312e-02,
          6.51946189e-02,   6.78398440e-02,   6.51946189e-02,
          5.74953312e-02,   4.53996524e-02,   2.98538285e-02,
          1.19293415e-02,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
       [  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   8.56447001e-03,   1.87783549e-02,
          2.52258062e-02,   2.74312135e-02,   2.52258062e-02,
          1.87783549e-02,   8.56447001e-03,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00]])
    
    np.testing.assert_allclose(
        fd1, fd1_test, rtol = 1e-5)

    np.testing.assert_allclose(
        fd3, fd3_test, rtol = 1e-5)

